---
title: "Getting started"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Getting started}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  dpi = 150,
  dev = "png",
  out.width = "100%",
  fig.retina = 2
)
```

```{r, message=FALSE}
library(vistool)
set.seed(1)
```

## What is vistool?

`vistool` helps you explore optimization concepts and model behavior with a consistent R6 API. Use it to:
- visualize regression and classification loss functions;
- inspect one- and two-dimensional objectives, including custom definitions;
- follow optimization traces for gradient descent, momentum, and Nesterov variants;
- compare model prediction surfaces and decision boundaries.

Every visualizer can render a static `ggplot2` view, while 2D objectives and models also support interactive `plotly` surfaces.

## Installation

You can install the development version from GitHub with [`pak`](https://pak.r-lib.org/):

```r
# install.packages("pak")
pak::pak("slds-lmu/vistool")
```

Prefer base R tooling? `remotes::install_github("slds-lmu/vistool")` works as well.

### Plotly backend and static export

Interactive surfaces rely on `plotly`, which accesses Python functionality through `reticulate`. `vistool` (via `reticulate >= 1.41`) calls `reticulate::py_require("kaleido")` on demand, provisioning a cached Python environment automatically when you first render or save a surface plot.

If you manage Python yourself, point `reticulate` to your interpreter and ensure `kaleido` is installed:

```r
install.packages("reticulate")
# Sys.setenv(RETICULATE_PYTHON = "/path/to/python")
reticulate::py_install("kaleido")
```

## Quick tour

The workflow is consistent across plot types:

1. Create a visualizer with `as_visualizer(...)` (computational setup).
2. Add optional layers via `add_*()` helpers.
3. Render with `plot(...)`, and optionally call `save(...)` to export the latest plot.

```r
# Loss functions
vis_loss = as_visualizer(lss("regr.mse"), y_pred = seq(-3, 3), y_true = 0)

# Objectives (1D/2D)
vis_obj2d = as_visualizer(obj("TF_branin"))
vis_surf  = as_visualizer(obj("TF_branin"), type = "surface")

# Models (mlr3 Task + Learner)
library(mlr3); library(mlr3learners)
task = tsk("pima")$select(c("insulin", "mass"))
learner = lrn("classif.svm", predict_type = "prob")
vis_model = as_visualizer(task, learner = learner)
```

```r
vis_model$add_boundary(values = c(0.3, 0.5, 0.7))
vis_model$add_training_data()
vis_surf$add_contours()
```

```r
vis_model$plot(show_title = FALSE)
vis_surf$plot()
vis_surf$plot(flatten = TRUE)
vis_model$plot(theme = list(palette = "plasma", text_size = 13))
vis_model$save("model.png", width = 8, height = 6)
```

## Example: visualizing an SVM

The following example mirrors a typical classification workflow with `mlr3`.

```{r example-workflow, message=FALSE, warning=FALSE}
library(mlr3verse)

# Create an example task, add missing data imputation, and select two features
task = tsk("pima")
task = po("imputemean")$train(list(task))[[1]]
task$select(c("insulin", "mass"))

# Configure learner and build a 2D visualization
learner = lrn("classif.svm", predict_type = "prob")
vis_2d = as_visualizer(task, learner = learner)

vis_2d$plot()
```

To explore the same setup interactively, switch to the surface visualizer:

```{r example-surface, eval=FALSE}
vis_surface = as_visualizer(task, learner = learner, type = "surface")
vis_surface$set_scene(x = 1.4, y = 1.4, z = 1.4)
vis_surface$plot()
```

You can also save the surface as a static image once `kaleido` is available:

```{r example-save, eval=FALSE}
vis_surface$save("demo_surface.png", width = 500, height = 500)
```

## Next steps

Dive deeper with the dedicated articles on the pkgdown site:

- [Loss functions](https://slds-lmu.github.io/vistool/articles/loss_functions.html)
- [Model predictions](https://slds-lmu.github.io/vistool/articles/model.html)
- [Objective functions](https://slds-lmu.github.io/vistool/articles/objective.html)
- [Optimization traces](https://slds-lmu.github.io/vistool/articles/optimization_traces.html)

Styling and composition:
- [Customization guide](customization_guide.html)
- [Advanced visualization](advanced_visualization.html)

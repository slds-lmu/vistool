<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Developer reference • vistool</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Developer reference"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">vistool</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>Core</h6></li>
    <li><a class="dropdown-item" href="articles/loss_functions.html">Loss functions</a></li>
    <li><a class="dropdown-item" href="articles/model.html">Model predictions</a></li>
    <li><a class="dropdown-item" href="articles/objective.html">Objective functions</a></li>
    <li><a class="dropdown-item" href="articles/optimization_traces.html">Optimization &amp; traces</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Customization</h6></li>
    <li><a class="dropdown-item" href="articles/customization_guide.html">Customization guide</a></li>
    <li><a class="dropdown-item" href="articles/advanced_visualization.html">Advanced visualization</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Developer reference</h1>

    </div>

<div id="developer-reference" class="section level1">

<div class="section level2">
<h2 id="essential-commands">Essential commands<a class="anchor" aria-label="anchor" href="#essential-commands"></a></h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load package for development</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">load_all</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Install all dependencies  </span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_deps</span><span class="op">(</span>dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check package (like R CMD check)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">check</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run all tests</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">test</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run specific test file</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">test_active_file</span><span class="op">(</span><span class="st">'tests/testthat/test-plot-customization.R'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Install package locally</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build source tarball</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">build</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate function documentation from roxygen2 comments</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">document</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build README.md from README.Rmd</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">build_readme</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build all vignettes</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">build_vignettes</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build a specific vignette</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">load_all</span><span class="op">(</span><span class="op">)</span>; <span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html" class="external-link">render</a></span><span class="op">(</span><span class="st">'vignettes/loss_functions.Rmd'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build package website</span></span>
<span><span class="fu">pkgdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgdown.r-lib.org/reference/build_site.html" class="external-link">build_site</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Preview website locally</span></span>
<span><span class="fu">pkgdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgdown.r-lib.org/reference/preview_site.html" class="external-link">preview_site</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="structure">Structure<a class="anchor" aria-label="anchor" href="#structure"></a></h2>
<pre><code>vistool/
├── DESCRIPTION         # Package metadata, dependencies
├── NAMESPACE           # Exports (auto-generated by roxygen2)
├── README.Rmd          # Source for GitHub README
├── NEWS.md             # Changelog
├── CONTRIBUTING.md     # This file
├── R/                  # R source code
│   ├── as_visualizer.r # main user interface
│   ├── LossFunction.R  # Loss functions
│   ├── Objective.R     # Objective function classes
│   ├── Optimizer.R     # Optimization algorithms
│   ├── Visualizer*.R   # Visualization classes
│   └── zzz.R           # Package imports
├── man/                # Documentation (auto-generated)
├── man-roxygen/        # Roxygen2 templates
├── tests/testthat/     # Test files
├── vignettes/          # Long-form documentation
└── .github/workflows/  # CI/CD</code></pre>
</div>
<div class="section level2">
<h2 id="core-architecture-visualization">Core architecture (visualization)<a class="anchor" aria-label="anchor" href="#core-architecture-visualization"></a></h2>
<pre><code>Visualizer
├── VisualizerModel      # Handles both 1D and 2D
├── VisualizerObj        # Handles both 1D and 2D
├── VisualizerLossFuns
└── VisualizerSurface    # plotly-based
    ├── VisualizerSurfaceModel
    └── VisualizerSurfaceObj</code></pre>
<ul><li>
<strong><code>Visualizer</code></strong>: Base visualization class
<ul><li>
<code>VisualizerLossFuns</code>: Plotting loss functions with ggplot2</li>
<li>
<code>VisualizerModel</code>: Plotting model predictions with ggplot2</li>
<li>
<code>VisualizerObj</code>: Plotting objective functions with ggplot2</li>
<li>
<code>VisualizerSurface*</code>: Interactive surface plotting with plotly for 2D functions <em>only</em>
</li>
</ul></li>
<li>
<strong><code><a href="reference/as_visualizer.html">as_visualizer()</a></code></strong>: Smart constructor that selects appropriate visualizer</li>
</ul></div>
<div class="section level2">
<h2 id="api-design-principles">API design principles<a class="anchor" aria-label="anchor" href="#api-design-principles"></a></h2>
<div class="section level3">
<h3 id="constructor-vs-styling-separation">Constructor vs. styling separation<a class="anchor" aria-label="anchor" href="#constructor-vs-styling-separation"></a></h3>
<p><strong>Constructors</strong> (<code><a href="reference/as_visualizer.html">as_visualizer()</a></code>, <code>VisualizerModel$new()</code>, etc.) accept only: - <strong>Domain objects</strong>: tasks, learners, objectives, loss functions - <strong>Computational parameters</strong>: limits, padding, n_points, grids</p>
<p><strong>Styling</strong> is handled separately via: - <strong>Instance theme</strong>: <code>vis$set_theme(vistool_theme(...))</code> - <strong>Plot theme</strong>: <code>vis$plot(theme = list(...), ...)</code> - <strong>Layer styling</strong>: <code>vis$add_points(color = "red", size = 3)</code></p>
</div>
<div class="section level3">
<h3 id="example-workflow">Example workflow<a class="anchor" aria-label="anchor" href="#example-workflow"></a></h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Create visualizer (computational setup only)</span></span>
<span><span class="va">vis</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/as_visualizer.html">as_visualizer</a></span><span class="op">(</span><span class="va">task</span>, learner <span class="op">=</span> <span class="va">learner</span>, n_points <span class="op">=</span> <span class="fl">200</span>, padding <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. Set styling preferences</span></span>
<span><span class="va">vis</span><span class="op">$</span><span class="fu">set_theme</span><span class="op">(</span><span class="fu"><a href="reference/vistool_theme.html">vistool_theme</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"plasma"</span>, text_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. Add layers with auto colors</span></span>
<span><span class="va">vis</span><span class="op">$</span><span class="fu">add_training_data</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"auto"</span><span class="op">)</span>  <span class="co"># Uses theme palette</span></span>
<span><span class="va">vis</span><span class="op">$</span><span class="fu">add_boundary</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>        <span class="co"># Explicit override</span></span>
<span></span>
<span><span class="co"># 4. Plot with optional theme override</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">vis</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span>theme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 5. Save (uses cached plot for efficiency)</span></span>
<span><span class="va">vis</span><span class="op">$</span><span class="fu">save</span><span class="op">(</span><span class="st">"plot.png"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="theme-system">Theme system<a class="anchor" aria-label="anchor" href="#theme-system"></a></h2>
<p>vistool uses a flexible theme system that separates “what to plot” from “how to plot”:</p>
<div class="section level3">
<h3 id="theme-hierarchy-precedence">Theme hierarchy (precedence)<a class="anchor" aria-label="anchor" href="#theme-hierarchy-precedence"></a></h3>
<ol style="list-style-type: decimal"><li>
<strong>Layer-specific style</strong> (highest): <code>add_points(color = "red")</code>
</li>
<li>
<strong>Plot theme override</strong>: <code>plot(theme = list(palette = "plasma"))</code>
</li>
<li>
<strong>Instance theme</strong>: <code>vis$set_theme(vistool_theme(...))</code>
</li>
<li>
<strong>Package default</strong> (lowest): Set via <code>options(vistool.theme = ...)</code>
</li>
</ol></div>
<div class="section level3">
<h3 id="theme-usage">Theme usage<a class="anchor" aria-label="anchor" href="#theme-usage"></a></h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set instance theme</span></span>
<span><span class="va">vis</span><span class="op">$</span><span class="fu">set_theme</span><span class="op">(</span><span class="fu"><a href="reference/vistool_theme.html">vistool_theme</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"plasma"</span>, text_size <span class="op">=</span> <span class="fl">14</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Override theme for single plot</span></span>
<span><span class="va">vis</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span>theme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>text_size <span class="op">=</span> <span class="fl">12</span>, theme <span class="op">=</span> <span class="st">"bw"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Layer-specific styling (highest precedence)</span></span>
<span><span class="va">vis</span><span class="op">$</span><span class="fu">add_points</span><span class="op">(</span><span class="va">data</span>, color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="deferred-rendering">Deferred rendering<a class="anchor" aria-label="anchor" href="#deferred-rendering"></a></h2>
<p>All visualizer classes in vistool follow a standardized <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method structure that leverages the deferred rendering architecture. This ensures consistent behavior, proper color resolution, and maintainable code.</p>
<div class="section level3">
<h3 id="standard-pattern">Standard pattern<a class="anchor" aria-label="anchor" href="#standard-pattern"></a></h3>
<div class="section level4">
<h4 id="id_1-visualizerr">1. <code>Visualizer.R</code>
<a class="anchor" aria-label="anchor" href="#id_1-visualizerr"></a></h4>
<p>The base <code>Visualizer</code> class provides: - <strong>Layer storage</strong>: <code>private$store_layer(type, spec)</code> - <strong>Layer retrieval</strong>: <code>private$get_layers_by_type(type)</code> - <strong>Theme management</strong>: Effective theme resolution in <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method - <strong>Color resolution</strong>: Auto colors resolved using effective theme palette</p>
<p>CAREFUL: Its <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method needs to be called by all child classes (<code>VisualizerSurface</code>, <code>VisualizerModel</code>, …) to resolve effective theme and prepare rendering.</p>
</div>
<div class="section level4">
<h4 id="id_2-child-classes">2. Child classes<a class="anchor" aria-label="anchor" href="#id_2-child-classes"></a></h4>
<p>These extend the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method from the base <code>Visualizer</code> class and add methods specific for that type (e.g., <code>add_contours()</code> for all <code>VisualizerSurface</code> classes, <code>add_optimization_trace</code> for <code>Visualizer*Obj</code>), they inherit from <code>Visualizer</code> or <code>VisualizerSurface</code>.</p>
<p><code>VisualizerLossFuns</code>, <code>VisualizerModel</code>, <code>VisualizerObj</code>, <code>VisualizerSurfaceModel</code>, <code>VisualizerSurfaceObj</code> should all follow this pattern:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># 1. ALWAYS call parent first to resolve effective theme and setup</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">super</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="va">...</span><span class="op">)</span>  <span class="co"># or just super$plot(...) for plotly classes</span></span>
<span>  </span>
<span>  <span class="co"># 2. Render class-specific layers using dedicated private methods</span></span>
<span>  <span class="va">private</span><span class="op">$</span><span class="fu">render_layer_type_1</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">private</span><span class="op">$</span><span class="fu">render_layer_type_2</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="co"># ... etc</span></span>
<span>  </span>
<span>  <span class="co"># 3. Resolve auto colors using effective theme</span></span>
<span>  <span class="va">self</span><span class="op">$</span><span class="fu">resolve_layer_colors</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># 4. Cache and return the plot object (for ggplot2 classes only)</span></span>
<span>  <span class="va">private</span><span class="op">$</span><span class="va">.last_plot</span> <span class="op">=</span> <span class="va">p</span>  <span class="co"># Cache for save() method</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>  <span class="co"># omit for plotly classes that modify private$.plot</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="implementation-examples">Implementation examples<a class="anchor" aria-label="anchor" href="#implementation-examples"></a></h3>
<div class="section level4">
<h4 id="ggplot2-based-classes-1d-2d">ggplot2-based classes (1D, 2D)<a class="anchor" aria-label="anchor" href="#ggplot2-based-classes-1d-2d"></a></h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Call parent to resolve effective theme and prepare rendering</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">super</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># render layers in the order they were added</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">private</span><span class="op">$</span><span class="va">.layers_to_add</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">layer</span> <span class="kw">in</span> <span class="va">private</span><span class="op">$</span><span class="va">.layers_to_add</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="va">layer</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"optimization_trace"</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">p</span> <span class="op">=</span> <span class="va">private</span><span class="op">$</span><span class="fu">render_optimization_trace_layer</span><span class="op">(</span><span class="va">p</span>, <span class="va">layer</span><span class="op">$</span><span class="va">spec</span><span class="op">)</span></span>
<span>      <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">layer</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"layer_type_2"</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="co"># render layer_type_2</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="co"># ... handle other layer types</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Resolve auto colors using effective theme</span></span>
<span>  <span class="va">self</span><span class="op">$</span><span class="fu">resolve_layer_colors</span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Cache and return plot</span></span>
<span>  <span class="va">private</span><span class="op">$</span><span class="va">.last_plot</span> <span class="op">=</span> <span class="va">p</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">private</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  render_optimization_trace_layers <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">plot_obj</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">trace_layers</span> <span class="op">&lt;-</span> <span class="va">private</span><span class="op">$</span><span class="fu">get_layers_by_type</span><span class="op">(</span><span class="st">"optimization_trace"</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">trace_layers</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">plot_obj</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">trace_spec</span> <span class="kw">in</span> <span class="va">trace_layers</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">plot_obj</span> <span class="op">&lt;-</span> <span class="va">private</span><span class="op">$</span><span class="fu">render_optimization_trace_layer</span><span class="op">(</span><span class="va">plot_obj</span>, <span class="va">trace_spec</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">plot_obj</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="plotly-based-classes-surface">plotly-based classes (surface)<a class="anchor" aria-label="anchor" href="#plotly-based-classes-surface"></a></h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Good Example: VisualizerSurfaceObj  </span></span>
<span><span class="va">plot</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Call parent to resolve effective theme</span></span>
<span>  <span class="va">super</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Render stored layers (modifies private$.plot directly)</span></span>
<span>  <span class="va">private</span><span class="op">$</span><span class="fu">render_optimization_trace_layers</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">private</span><span class="op">$</span><span class="fu">render_taylor_layers</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">private</span><span class="op">$</span><span class="fu">render_hessian_layers</span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Resolve auto colors using effective theme</span></span>
<span>  <span class="va">self</span><span class="op">$</span><span class="fu">resolve_layer_colors</span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Cache and return plot</span></span>
<span>  <span class="va">private</span><span class="op">$</span><span class="va">.last_plot</span> <span class="op">=</span> <span class="va">private</span><span class="op">$</span><span class="va">.plot</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">private</span><span class="op">$</span><span class="va">.plot</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">private</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  render_optimization_trace_layers <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">trace_layers</span> <span class="op">&lt;-</span> <span class="va">private</span><span class="op">$</span><span class="fu">get_layers_by_type</span><span class="op">(</span><span class="st">"optimization_trace"</span><span class="op">)</span></span>
<span>    <span class="co"># ... process layers, modify private$.plot directly</span></span>
<span>    <span class="co"># Colors are resolved using private$.effective_theme$palette</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="development-workflow">Development workflow<a class="anchor" aria-label="anchor" href="#development-workflow"></a></h2>
<div class="section level3">
<h3 id="id_1-setup-development-environment">1. Setup development environment<a class="anchor" aria-label="anchor" href="#id_1-setup-development-environment"></a></h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/slds-lmu/vistool.git</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="bu">cd</span> vistool</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">load_all</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_deps</span><span class="op">(</span>dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_2-make-changes">2. Make changes<a class="anchor" aria-label="anchor" href="#id_2-make-changes"></a></h3>
<p>Edit files in <code>R/</code>, add roxygen2 documentation:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' @title Brief description</span></span>
<span><span class="co">#' @description Detailed description  </span></span>
<span><span class="co">#' @param x Parameter description</span></span>
<span><span class="co">#' @return Return value description</span></span>
<span><span class="co">#' @examples</span></span>
<span><span class="co">#' # Example code</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">my_function</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Implementation</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>For reusable documentation blocks, consider using templates from <code>man-roxygen/</code> directory.</p>
</div>
<div class="section level3">
<h3 id="id_3-update-documentation">3. Update documentation<a class="anchor" aria-label="anchor" href="#id_3-update-documentation"></a></h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">document</span><span class="op">(</span><span class="op">)</span>  <span class="co"># Generate man/ files</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">build_readme</span><span class="op">(</span><span class="op">)</span>  <span class="co"># Update README.md</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_4-add-tests">4. Add tests<a class="anchor" aria-label="anchor" href="#id_4-add-tests"></a></h3>
<p>Test all public functions using <code>testthat</code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">test_that</span><span class="op">(</span><span class="st">"my feature works"</span>, <span class="op">{</span></span>
<span>  <span class="va">result</span> <span class="op">=</span> <span class="fu">my_function</span><span class="op">(</span><span class="va">input</span><span class="op">)</span></span>
<span>  <span class="fu">expect_equal</span><span class="op">(</span><span class="va">result</span>, <span class="va">expected</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_5-check-package">5. Check package<a class="anchor" aria-label="anchor" href="#id_5-check-package"></a></h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">test</span><span class="op">(</span><span class="op">)</span>    <span class="co"># Run tests</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">check</span><span class="op">(</span><span class="op">)</span>   <span class="co"># Full package check</span></span></code></pre></div>
<p>You can also check the rendered website:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pkgdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgdown.r-lib.org/reference/build_site.html" class="external-link">build_site</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="guidelines">Guidelines<a class="anchor" aria-label="anchor" href="#guidelines"></a></h2>
<div class="section level3">
<h3 id="naming-conventions">Naming conventions<a class="anchor" aria-label="anchor" href="#naming-conventions"></a></h3>
<ul><li>Classes (R6 generators and class-like objects): CamelCase
<ul><li>Examples: <code>Visualizer</code>, <code>VisualizerModel</code>, <code>Objective</code>, <code>OptimizerGD</code>
</li>
</ul></li>
<li>Everything else: snake_case
<ul><li>Functions: <code><a href="reference/as_visualizer.html">as_visualizer()</a></code>, <code><a href="reference/merge_theme.html">merge_theme()</a></code>, <code><a href="reference/get_vistool_color.html">get_vistool_color()</a></code>
</li>
<li>Variables/fields/args: <code>n_points</code>, <code>x_limits</code>, <code>effective_theme</code>
</li>
<li>Files: snake_case where feasible (e.g., <code>as_visualizer.R</code>); class files should retain CamelCase to match class names (e.g., <code>VisualizerModel.R</code>).</li>
</ul></li>
</ul><p>Tooling: - lintr: <code>.lintr</code> config allows both <code>snake_case</code> and <code>CamelCase</code>. It cannot distinguish classes from other objects, so we enforce “CamelCase only for classes” via code review and PRs. If you must use a non-conforming name due to external APIs, add a short comment and, if necessary, a targeted <code># nolint: object_name_linter.</code> on that line. - styler: formatting only; it does not rename identifiers. See <code>.styler</code> for formatting configuration.</p>
<p>Documentation titles should use <strong>Sentence case</strong>.</p>
</div>
<div class="section level3">
<h3 id="testing">Testing<a class="anchor" aria-label="anchor" href="#testing"></a></h3>
<ul><li>Each R file should have corresponding test file</li>
<li>Use descriptive test names: <code>test_that("objective evaluation works", ...)</code>
</li>
<li>Test both success and failure cases</li>
<li>Use appropriate <code>expect_*()</code> functions</li>
</ul><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Skip tests requiring Python dependencies on CI</span></span>
<span><span class="fu">skip_on_ci</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Skip if optional package not available  </span></span>
<span><span class="fu">skip_if_not_installed</span><span class="op">(</span><span class="st">"plotly"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="documentation-with-roxygen2">Documentation with <code>roxygen2</code>
<a class="anchor" aria-label="anchor" href="#documentation-with-roxygen2"></a></h3>
<ul><li>Use <code>roxygen2</code> tags (<code>@title</code>, <code>@description</code>, <code>@param</code>, <code>@return</code>, <code>@examples</code>)</li>
<li>Include working examples</li>
<li>Document all parameters</li>
<li>Use consistent style with existing code</li>
<li>For reusable documentation blocks, use templates in <code>man-roxygen/</code> directory.</li>
</ul></div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marc Becker, Daniel Schalk, Lukas Burk, Manuel Helmerichs.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>


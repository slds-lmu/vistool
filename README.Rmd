---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include=FALSE}
lgr::get_logger("mlr3")$set_threshold("warn")
lgr::get_logger("mlr3spatial")$set_threshold("warn")
set.seed(1)
options(width = 80)

knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
REBUILD <- TRUE
RECREATE_ALL_2DFIGS <- FALSE
```

# vistool

<!-- badges: start -->
[![r-cmd-check](https://github.com/slds-lmu/vistool/actions/workflows/r-cmd-check.yaml/badge.svg)](https://github.com/slds-lmu/vistool/actions/workflows/r-cmd-check.yaml)
<!-- badges: end -->

The goal of `vistool` is to visualize optimization traces and aid in teaching optimization-related concepts. 

## Backend Selection with as_visualizer()

The `as_visualizer()` function provides intelligent automatic backend selection:

- **Automatic selection**: Chooses ggplot2 for 1D/2D objectives and plotly for 3D+ objectives
- **Manual override**: Use `type = "2d"` to force ggplot2 or `type = "3d"` to force plotly 
- **1D visualizations**: Always use ggplot2 (fast, publication-ready plots)
- **2D visualizations**: ggplot2 by default, plotly available for interactivity
- **3D+ visualizations**: Always use plotly (interactive surface and contour plots)

**Why this matters:**
- ggplot2 visualizations work immediately with base R dependencies
- plotly visualizations require Python dependencies but provide interactivity
- The function automatically selects the best backend for your data dimensions

## Installation

You can install the development version of vistool from [GitHub](https://github.com/) with:

``` r
# install.packages("pak")
pak::pak("slds-lmu/vistool")
```

Please note that 3D visualization features rely on [`plotly`]() which in turns relies on certain functionality provided by Python packages, which are accessed via reticulate.  
Most importantly this affects the `$save()` functionality for 3D plots, which uses `plotly::save_image()` internally, and requires the `kaleido` Python package. 2D visualizations use ggplot2 and can be saved using standard ggplot2 methods.

The following instructions are provided by `?plotly::save_image` and assume you do not have `miniconda` installed already:

```r
install.packages('reticulate')
reticulate::install_miniconda()
reticulate::conda_install('r-reticulate', 'python-kaleido')
reticulate::conda_install('r-reticulate', 'plotly', channel = 'plotly')
reticulate::use_miniconda('r-reticulate')
```

## Example

```{r example-setup}
library(vistool)
library(mlr3verse)
```


This examples shows how to visualize the prediction surface of an SVM on the `pima` task included in `mlr3`:

```{r example}
# Create an example task, add missing data imputation and select 2 features
task <- tsk("pima")
task <- po("imputemean")$train(list(task))[[1]]
task$select(c("insulin", "mass"))

# Select example learner
learner <- lrn("classif.svm", predict_type = "prob")

# Create the Visualizer object from task and learner
# Use 3D visualization for interactive plotly surface plot
vis <- as_visualizer(task, learner, type = "3d")

# Define a 3D scene
vis$set_scene(x = 1.4, y = 1.4, z = 1.4)
```

For comparison, you can also create 2D ggplot2 visualizations:

```{r example-2d, eval=FALSE}
# 2D visualization with ggplot2 (default for 2-feature tasks)
vis_2d <- as_visualizer(task, learner) # or explicitly: type = "2d"
vis_2d$plot()
```

View interactively:

```{r example-plot, eval=FALSE}
vis$plot()
```

![](man/figures/demo_1.png)

Save static version as png:

```{r example-save, eval=FALSE}
# only works if Python kaleido package is installed
# see installation instructions above for setting up plotly save functionality
vis$save("man/figures/demo_1.png", width = 500, height = 500)
```

## Contributing

For developers interested in contributing to `vistool`, please see the [Developer Reference](DEVELOPMENT.md).

## Resources 

For visualization of...

* [Loss Functions](https://slds-lmu.github.io/vistool/articles/loss_functions.html)
* [Model Predictions](https://slds-lmu.github.io/vistool/articles/model.html)
* [Objective Functions](https://slds-lmu.github.io/vistool/articles/objective.html)
